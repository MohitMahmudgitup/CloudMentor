<%- include('../partials/header') %>
<main class="main">
    <h1 class="dashboard-title">Welcome, <%= user.name %></h1>

    <section class="dashboard-section">
        <h2 class="section-title">Book a Session</h2>
        <form action="/student/book-session" method="POST" class="booking-form">
            <div class="form-group">
                <label for="tutorId">Select Tutor</label>
                <select name="tutorId" id="tutorId" required>
                    <% tutors.forEach(tutor => { %>
                        <option value="<%= tutor._id %>"><%= tutor.name %> - $<%= tutor.hourlyRate %>/hr</option>
                    <% }) %>
                </select>
            </div>
            <div class="form-group">
                <label for="date">Select Date</label>
                <input type="date" name="date" id="date" required>
            </div>
            <div class="form-group">
                <label for="duration">Duration (hours)</label>
                <input type="number" name="duration" id="duration" min="1" required>
            </div>
            <button type="submit" class="btn btn-primary">Book Session</button>
        </form>
    </section>

    <section class="dashboard-section">
        <h2 class="section-title">Your Sessions</h2>
        <% if (sessions.length > 0) { %>
            <div class="sessions-list">
                <% sessions.forEach(session => { %>
                    <div class="session-item">
                        <p>Tutor: <a href="/student/tutor/<%= session.tutor._id %>"><%= session.tutor.name %></a></p>
                        <p>Date: <%= session.date.toLocaleString() %></p>
                        <p>Status: <%= session.status %></p>
                        <% if (!session.payment) { %>
                            <form action="/student/pay" method="POST">
                                <input type="hidden" name="sessionId" value="<%= session._id %>">
                                <button type="submit" class="btn btn-primary">Pay Now</button>
                            </form>
                        <% } %>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <p class="empty-message">No sessions booked yet.</p>
        <% } %>
    </section>
</main>
<%- include('../partials/footer') %>